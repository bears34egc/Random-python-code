import pandas as pd
from sqlalchemy import create_engine, MetaData, Table, select
import unicodedata
import pandas.io.sql
import pyodbc
import pandas as pd
from sqlalchemy import create_engine, MetaData, Table, select, String
import sys

dir=('C:\\Users\\ecoker\\Documents\\Chats\\')
file= 'chats.csv'

def safe_str(obj):
    """ return the byte string representation of obj """
    try:
        return str(obj)
    except UnicodeEncodeError:
        # obj is unicode
        return unicode(obj).encode('unicode_escape')

engine2=create_engine("mysql+mysqldb://root:password@127.0.0.1:3306/schema")
frame=pd.read_sql_query("SELECT * \
FROM `schema`.`tablename` WHERE timestamp > '2015-01-01';", engine2)

# frame.subject = safe_str(frame.subject)

print frame.info()
print frame.head()
print frame.tail()


frame.to_csv(dir + file,na_rep='',decoding='ISO-8859-1',)

print 'complete'
